<body id='body'>
	<script type="text/javascript">
		var refresh_rate = 100;  //milliseconds
		class Animal {
			speed = 0;
			left = 0;
			image = null;
			walkMode = 'auto';   //'manual', 'auto'
			keyTimer = 0;
			constructor(imgSrc='', height=0, width=0, speed=0) {
				//1.create an image, and append it to the 'body'
				this.image = document.createElement('img');
				this.image.src = imgSrc;
				if (height > 0) {
					this.image.height = height;	
				}
				if (width > 0) {
					this.image.width = width;
				}
				if (speed > 0) {
					this.speed = speed;
				}
				this.image.style.position = "relative";
				document.getElementById('body')
					.appendChild(document.createElement('div'))
					.appendChild(this.image);
				//2.set click action: stop or walk
				this.onClickAction('walk');
			}
			onClickAction(action='stop'){
				var that = this;
				//1.if want to stop on click then assign stop() to the event handler
				if (action === 'stop') {
					this.image.onclick = function(){that.stop();};
				}
				//2.if want to move on click then assign walk() to the event handler
				else {
					this.image.onclick = function(){that.walk();};	
				}
			}
			//3.add a parameter to specify the distance to walk (in px)
			walkOneStep(distance=0){
				//1.increase the left position attribute/property of the object, by "speed"
				this.left += distance
				//2.assign the position to the left attribute of the image
				this.image.style.left = this.left + 'px'
			}
			//2.define a member function to determine 'auto' move or 'manual' move
			walk(){
				if (this.walkMode === 'auto') {	
					//2.1.if 'auto' mode, initialize a timer to call walkOneStep()
					var that = this;
					if (this.keyTimer === 0) {
						this.keyTimer = setInterval(function() {that.walkOneStep(that.speed * refresh_rate / 1000)}, 
							refresh_rate);
						this.onClickAction('stop');
					}
				}
				else {
					//2.2.else, just call walkOneStep() once.
					this.walkOneStep(this.speed);					
				}
			}
			stop(){
				if (this.keyTimer > 0) {
					clearTimeout(this.keyTimer);
					this.keyTimer = 0;
				}
				this.onClickAction('walk');
			}			
		}
		class Mouse extends Animal {
			constructor(height=0, width=0, speed=0){
				super('mouse_right.png', height, width, (speed==0)?10:speed);
			}
		}
		class Cat extends Animal {
			constructor(height=0, width=0, speed=0){
				super('cat_right.png', height, width, (speed==0)?20:speed);
			}
		}
		var mouse1 = new Mouse();
		var mouse2 = new Mouse(0, 48, 15);
		var cat1 = new Cat();
		var cat2 = new Cat(0, 117, 30);
	</script>
</body>





